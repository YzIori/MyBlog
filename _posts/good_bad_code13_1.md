---
title: '【要約】良いコード/悪いコードで学ぶ設計入門 【13章】'
excerpt: '良いコード/悪いコードで学ぶ設計入門の自分用まとめ'
coverImage: '/assets/blog/dynamic-routing/good_bad_code.png'
date: '2022-1-14'
ogImage:
  url: '/assets/blog/dynamic-routing/good_bad_code.png'
tags:
  - '設計'
  - '初心者'
  - 'Java'
---

# 良いコード/悪いコードで学ぶ設計入門　 13 章まとめ 1

## 邪悪な構造に陥りがちな User クラス

bad code
ログインに必要最低限な情報を持つように実装されたが、、、

```Java
class User {
  int id;
  String name;
  String email;
  String passwordDigest;
}
```

その後、様々な仕様が盛り込まれ、多くのインスタンス変数を持つ構造に、、、

```Java
class User {
  int id;                   // 識別ID
  String name;              // 名前
  String email;             // Eメールアドレス
  String passwordDigest;　　// パスワード
  String address;           // 住所
  String phoneNumber;       // 電話番号
  String bio;               // 自己紹介
  String url;               // URL
  int discountPoint;        // 割引ポイント
  String themeMode;         // 表示テーマ色
  LocalDate birthday;       // 生年月日
  // 省略。その他多くのインスタンス変数
}
```

サービスがローンチされしばらくした後、ほかの業者も商品を出品できるよう仕様変更がされた。法人ユーザーとして登録できるよう User クラスを使うことに、、、<br>

その際、業者の身元がわかるように、法人番号を User クラスに追加。

```Java
class User {
  //　省略
  String corporationNumber;
}
```

NOTE: 点線矢印は「依存関係」を示す。クラス A がクラス B のメソッドやプロパティを使用していることを示すとき、点線矢印はクラス A からクラス B に向かって引かれる。

UserManager クラスとは別に、法人ユーザを登録・管理する CorporationManager クラスも作られた。その後、様々なバグが…

### 弊害

- 生年月日の登録がいらない CorporationManager 側で登録された User を、UserManager 側で読み込んでしまったため NullPointerException。
- バリデーションのルールが 2 つのクラスでそれぞれ異なるためバリデーションエラーが多発。
- User クラスの様々なインスタンス変数に関して NullPointerException などのエラーがおこるようになり、正常動作させるために null チェック用の条件分岐やらバグ回避用のロジックを追加したり、メンテンナンスが難しい状態になってしまった。

### 原因

うまくモデリングされていないことが原因。

## モデリングの考え方とあるべき構造

モデリングの理解のためには、そもそもシステムが何であるかを理解しなければならない。

### システムとは何か

辞書での定義

「きわめて多数の構成要素から成る集合体で、各部分が有機的に連携（レンケイ）して、全体としてひとつの目的を持った仕事をするもの。」

具体例

- 目的地へ移動するとき、人間は二本脚を交互に動かすことで移動する、二足歩行システムを用いている。
- 意思疎通では、話者が発声器官を使って話し、聞き手が鼓膜で音を拾う、音波を用いた会話システムを用いている。

目的地への移動に関して、二足歩行の代わりに自動車や飛行機などの別システムを使える。つまり社会活動は、あるシステムから別のシステムへ代替可能。

二足歩行と比較して、自動車や飛行機は何倍も速く移動できる。つまり、目的達成するためにシステムは作り出される。<strong>システムは目的達成のための手段</strong>なのだ。
システムの内、コンピューターを利用したものを情報システムと呼ぶ。

### システム構造とモデリング

システム構造を説明するために、単純な箱で図式化したものをモデルと呼ぶ。モデルの意図を定義し、構成を設計することをモデリングと呼ぶ。

整理すると

- システムは目的達成手段。
- モデルはシステムの構成要素。つまり、モデルは目的達成手段の一部。

これらから<strong>特定の目的達成のために最低限考慮が必要な要素を備えたものがモデル。</strong>

### ソフトウェア設計におけるモデリング

目的それぞれで商品モデルが異なる。
