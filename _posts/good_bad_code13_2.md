---
title: '【要約】良いコード/悪いコードで学ぶ設計入門 【13章】'
excerpt: '良いコード/悪いコードで学ぶ設計入門の自分用まとめ'
coverImage: '/assets/blog/dynamic-routing/good_bad_code.png'
date: '2022-1-14'
ogImage:
  url: '/assets/blog/dynamic-routing/good_bad_code.png'
tags:
  - '設計'
  - '初心者'
  - 'Java'
---

# 良いコード/悪いコードで学ぶ設計入門　 13 章まとめ 2

## 良くないモデルの問題点と解決方法

モデルは「特定の目的達成のために最低限考慮が必要な要素を備えたもの」です。
それでは、User モデルの目的は何？

…

そうですね、User クラスは、複数の目的ために無理やり利用されており、モデリングしているようでモデリングしていないと言える。このようなモデルを<strong>一貫性がない</strong>という。

設計品質が問題になる現場では、ろくにモデリングされず、ただ動くだけのコードが書かれることが多い。モデリングには、対象とする社会活動や目的の理解が必須なのです。

### User とシステムの関係

ユースケース図を見てみると、アクターすなわちシステム利用者は、システムの外側にいる。システムとは社会活動を効率化するために作り出され、利用されるもの。その中に User として組み込まれているのは不自然な感じ。よく考えると商品も物理的にはシステムの外にいる。しかし、一方で名前や生年月日、Email、そして売値や在庫数など利用者や商品の付帯要素は、システムを動作させる上で必要。

この一見いびつなこの関係を解消しなければならない。解消の鍵は情報システムが持つ、物理システムとは大きく異なる特徴にある。

### 仮想世界を表現する情報システム

情報システムというのは、現実世界の概念のみをコンピューターの世界へ投影した仮想現実の世界である。現実世界の概念をコンピュータの仮想世界へ変換し、意味を対応付け、そして概念的なやりとりをコンピューターによって高速化することで効率化していると考えることができる。

### 目的別にモデリングする

利用者に関して、目的に応じたモデルを考えてみる。GitHub のユーザ設定画面。このように情報システムでは、現実世界での物理的な存在と、情報システム上のモデルが 1:1 になるとは限らず、1:多の関係になるケースがあることが大きな特徴。

もうひとつの観点として、User という名前が曖昧なことが挙げられる。個人ユーザとも法人ユーザとも、どうとでも解釈可能で、大雑把でガバガバな名前。目的を表現した名前へ設計し直すことも重要。

### モデルはモノではなく目的達成手段

モデリングがうまくいかない原因は、モデルを単なるモノとして解釈していることが原因の一端。ユーザーであれ、商品であれ、モノとして解釈するとあらゆる目的で使われ、さまざまなデータが詰め込まれて巨大化し、一貫性のない構造になってしまう。<strong>目的駆動で名前設計することが、適切に目的達成するモデルを設計することにつながる。</strong>

### 単一責任とは単一目的

単一責任の原則とは、単一目的の原則。クラスが果たす目的は、たった一つに限定するべき。

クラスというと「共通利用可能な、汎用的な部品として設計するもの」と考えている方がいるかもしれないが、それは逆。<strong>特定の目的に特化して設計することで、変更に強い高品質な構造となる。

### モデルの見直し方

クラスの構造に問題がある場合、モデルに問題がある。モデルにいびつな不自然さがあり、一貫性がない場合は以下を検討してみること。

- そのモデルが達成しようとしている目的を洗い出す。
- 目的それぞれ特化したモデリングをし直す。
- 目的駆動名前設計に基づき、モデルを命名する。
- モデルに目的外の要素が入り込んでいる場合、さらに見直す。

### モデルと実装は必ず相互にフィードバックする

モデルはしくみを単純化したものであって、細部は描画されない。したがって、モデルに基づきクラスを設計し、コードを実装する。

クラスやコードに精緻化していく段階で、動作上の必須要素の見落としに気付くことがよくある。その際、気づいたことは必ずモデルにフィードバックするようにする。

フィードバックのサイクルを回し続けることが設計品質向上の秘訣。

## 機能性を左右するモデリング

機能性とはソフトウェア品質特性の一つで、顧客のニーズを満たす度合いのこと。

### 裏に隠れた真の目的を見破る

例えば、多くの EC サイトの利用規約では、「利用者の商品購入操作を持って売買契約を締結するものとする」と定義付けている。そうなるとモデリング上考慮しなければならないい構成要素が変わってくる。

機能性をうまく発揮するには、概念の正体や、裏に隠れた重大な目的を見破る必要がある。

### 機能性をイノベートする「深いモデル」

世の中の優れた仕組みは、優れた変換能力を有している。

コンピューターの本質は 0 と 1 の信号変換、および信号変換を応用した演算である。優れた変換能力を備えるようモデルを設計することが、機能性の革新につながる。

本質的課題を解決し、機能性の革新に貢献するモデルを、ドメイン駆動設計では深いモデルと呼ぶ。

深いモデルは一朝一夕に得られるものではない。試行錯誤を重ねてモデルの改良を繰り返していく内に発想が転換し、大きなブレークスルーを伴って深いモデルを獲得することができる。
